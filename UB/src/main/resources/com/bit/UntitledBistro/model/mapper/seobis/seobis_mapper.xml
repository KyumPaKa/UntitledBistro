<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bit.UntitledBistro.model.seobis.Seobis_MemberDAO">
  
  <insert id="Seobis_MemberInsert" parameterType="com.bit.UntitledBistro.model.seobis.Seobis_MemberDTO">
 	<![CDATA[
 	INSERT 
 	INTO MEMBER(
 	MEMBER_ID, 
 	MEMBER_NAME, 
 	MEMBER_EMAIL,
 	MEMBER_BIRTH,
 	MEMBER_GENDER, 
 	MEMBER_PHONE1)
	VALUES(
	#{member_id},
	#{member_name},
	#{member_email},
	TO_DATE(#{member_birth},'YYMMDD'),
	#{member_gender},
	#{member_phone1}
	)
 	]]>
 </insert>
 
 <select id="Seobis_MemberList"  parameterType="map"  resultType="com.bit.UntitledBistro.model.seobis.Seobis_MemberDTO">
 	<![CDATA[
 		SELECT
 			 MEMBER_ID, 
 			 MEMBER_NAME, 
 			 MEMBER_GENDER,
 			 TO_CHAR(MEMBER_BIRTH, 'YYMMDD') AS MEMBER_BIRTH,
 			 MEMBER_EMAIL,
 			 MEMBER_GRADE, 
 			 MEMBER_POINT, 
 			 MEMBER_PHONE1 , 
 			 MEMBER_REG 
 		 FROM
 			 MEMBER
	 ]]>
 </select>
 
  <select id="Seobis_MemberListCount" parameterType="map" resultType="java.lang.Integer">
 	<![CDATA[
 		SELECT 
 			COUNT(*) 
 		FROM
 			MEMBER
 		WHERE
		MEMBER_ID = #{reserve_member_id}
 	]]>
 </select>

 <delete id="Seobis_MemberDelete" parameterType="com.bit.UntitledBistro.model.seobis.Seobis_MemberDTO">
	<![CDATA[
		DELETE FROM MEMBER 
		WHERE MEMBER_ID = #{member_id}
	]]>
 </delete>

 <update id="Seobis_MemberUpdate" parameterType="com.bit.UntitledBistro.model.seobis.Seobis_MemberDTO">
	<![CDATA[
		UPDATE MEMBER 
		SET 
			MEMBER_NAME = #{member_name}, 
			MEMBER_GENDER = #{member_gender},
			MEMBER_BIRTH = #{member_birth},
			MEMBER_EMAIL = #{member_email},
			MEMBER_PHONE1 = #{member_phone1}
		WHERE 
			MEMBER_ID = #{member_id}
	]]>
 </update>
 
 <select id="Seobis_MemberSelect" parameterType="String"  resultType="com.bit.UntitledBistro.model.seobis.Seobis_MemberDTO">
 	<![CDATA[
 		SELECT 
		 	MEMBER_ID,
 		 	MEMBER_NAME,
 		 	MEMBER_GENDER,
 		 	TO_CHAR(MEMBER_BIRTH, 'YYMMDD') AS MEMBER_BIRTH,
 		 	MEMBER_EMAIL,
 		 	MEMBER_PHONE1,
 		 	MEMBER_GRADE,
 		 	MEMBER_POINT,
 		 	MEMBER_REG 
		FROM 
			MEMBER 
		WHERE MEMBER_ID=#{member_id}
 	]]>
 </select>
 
 <select id="Seobis_ReserveSelect"  resultType="com.bit.UntitledBistro.model.seobis.Seobis_ReserveDTO">
 	<![CDATA[
 		SELECT
 			RESERVE_NUM,
 			RESERVE_MEMBER_ID,
 			RESERVE_NAME,
 			RESERVE_DATE
 		FROM
 			RESERVE
 	]]>
 </select>
 
   <insert id="Seobis_ReserveAdd" parameterType="com.bit.UntitledBistro.model.seobis.Seobis_ReserveDTO">
 		<choose>
			<when test ="#{reserve_name} != null">
			<![CDATA[
 				INSERT 
	 				INTO RESERVE(
			 			RESERVE_NUM,
						RESERVE_MEMBER_ID,
 						RESERVE_PHONE1,
 						RESERVE_DATE)
						VALUES(
						#{reserve_num},
						#{reserve_member_id},
						#{reserve_phone1},
						#{reserve_dateString}
						)
 			]]>
			</when>

			<when test ="#{reserve_member_id} != null">
 			<![CDATA[
 				INSERT 
 					INTO RESERVE(
 						RESERVE_NUM,
 						RESERVE_NAME,
 						RESERVE_PHONE1,
 						RESERVE_DATE)
				VALUES(
						#{reserve_num},
						#{reserve_name},
						#{reserve_phone1},
						#{reserve_dateString}
						)
 			]]>
			</when>

<otherwise>
 			<![CDATA[
 				INSERT 
 					INTO RESERVE(
 						RESERVE_NUM,
 						RESERVE_MEMBER_ID,
 						RESERVE_NAME,
 						RESERVE_PHONE1,
 						RESERVE_DATE)
				VALUES(
						#{reserve_num},
						#{reserve_member_id},
						#{reserve_name},
						#{reserve_phone1},
						#{reserve_dateString}
						)
 			]]>
</otherwise>
</choose>
 </insert>
</mapper>